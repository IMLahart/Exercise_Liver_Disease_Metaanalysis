---
title: "Exercise_Liver_Disease_MA_Human"
author: "Ian M Lahart & Edward Stanhope"
date: "`r format(Sys.Date(),'%e de %B, %Y')`"
output: 
  pdf_document:
    latex_engine: xelatex
    includes:
      in_header: 
      - !expr system.file("includes/fig-valign.tex", package = "summarytools")
    toc: yes
    toc_depth: 3
---
<style>
body{
  font-size: 8pt;
}
</style>
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Packages

Packages required:
1) dmetar
2) tidyverse
3) meta
4) metafor

```{r install and load dmetar, include=FALSE}
if (!require("devtools")) {
  install.packages("devtools")
}
devtools::install_github("MathiasHarrer/dmetar")
library(dmetar)
```

```{r packages, include=FALSE}
#Install tidyverse package if needed for 'glimpse'
if(!require(tidyverse)){install.packages('tidyverse')}
#Load tidyverse package
library(tidyverse)

#Install meta package if needed for meta-analysis
if(!require(meta)){install.packages('meta')}
#Load meta package
library(meta)

#Install metafor package if needed for meta-analysis
if(!require(metafor)){install.packages('metafor')}
#Load metfor package
library(metafor)

#Install dmetar package if needed for meta-analysis
if(!require(dmetar)){install.packages('dmetar')}
#Load metfor package
library(dmetar)
```

## Meta-analysis: AST

```{r Read in AST data, include=FALSE}
Liver_disease_AST <- read.csv("MA_human_AST.csv", 
                      header = TRUE, sep = ",")
```

```{r AST meta-analysis}
m.AST <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_AST,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on AST")

m.AST <- update(m.AST, prediction = TRUE) # Adds the prediction interval

summary(m.AST) # Results of meta-analysis
```

```{r Outlier search AST}
find.outliers(m.AST) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases AST}
m.AST.inf <- InfluenceAnalysis(m.AST, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots AST}
plot(m.AST.inf, "baujat")
plot(m.AST.inf, "influence")
plot(m.AST.inf, "es")
plot(m.AST.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot AST}
m.rma_AST <- rma(yi = m.AST$TE,
             sei = m.AST$seTE,
             method = m.AST$method.tau,
             test = "knha")

res.gosh_AST <- gosh(m.rma_AST)

plot(res.gosh_AST, alpha = 0.01)

res.gosh.diag_AST <- gosh.diagnostics(res.gosh_AST, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_AST)
```

```{r Update analysis if necessary}
# update(m.AST, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot AST}
meta::forest(m.AST, layout = "RevMan5")
```

```{r Saving forest plot AST}
pdf(file = "AST_forestplot.pdf", width = 8, height = 7)

meta::forest(m.AST, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.AST, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression AST}
m.AST.reg <- metareg(m.AST, ~Age)
m.AST.reg
```


```{r Bubble plot AST}
bubble(m.AST.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot AST}
meta::funnel(m.AST,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (AST)")
```

```{r Contour funnel plot AST}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.AST, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (AST)")
```

```{r Egger's regression test}
metabias(m.AST, method.bias = "linreg")

# Alternative:
m.AST$n.e = n1; m.AST$n.c = n2
metabias(m.AST, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.AST_update <- update(m.AST, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.AST_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Meta-analysis: ALT

```{r Read in ALT data, include=FALSE}
Liver_disease_ALT <- read.csv("MA_human_ALT.csv", 
                      header = TRUE, sep = ",")
```

```{r ALT meta-analysis}
m.ALT <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_ALT,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on ALT")

m.ALT <- update(m.ALT, prediction = TRUE) # Adds the prediction interval

summary(m.ALT) # Results of meta-analysis
```

```{r Outlier search ALT}
find.outliers(m.ALT) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases ALT}
m.ALT.inf <- InfluenceAnalysis(m.ALT, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots ALT}
plot(m.ALT.inf, "baujat")
plot(m.ALT.inf, "influence")
plot(m.ALT.inf, "es")
plot(m.ALT.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot ALT}
m.rma_ALT <- rma(yi = m.ALT$TE,
             sei = m.ALT$seTE,
             method = m.ALT$method.tau,
             test = "knha")

res.gosh_ALT <- gosh(m.rma_ALT)

plot(res.gosh_ALT, alpha = 0.01)

res.gosh.diag_ALT <- gosh.diagnostics(res.gosh_ALT, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_ALT)
```

```{r Update analysis if necessary}
# update(m.ALT, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot ALT}
meta::forest(m.ALT, layout = "RevMan5")
```

```{r Saving forest plot ALT}
pdf(file = "ALT_forestplot.pdf", width = 10, height = 7)

meta::forest(m.ALT, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.ALT, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression ALT}
m.ALT.reg <- metareg(m.ALT, ~Age)
m.ALT.reg
```


```{r Bubble plot ALT}
bubble(m.ALT.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot ALT}
meta::funnel(m.ALT,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (ALT)")
```

```{r Contour funnel plot ALT}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.ALT, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (ALT)")
```

```{r Egger's regression test}
metabias(m.ALT, method.bias = "linreg")

# Alternative:
m.ALT$n.e = n1; m.ALT$n.c = n2
metabias(m.ALT, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.ALT_update <- update(m.ALT, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.ALT_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Meta-analysis: ALT/AST

```{r Read in ALT_AST data, include=FALSE}
Liver_disease_ALT_AST <- read.csv("MA_human_ALT_AST.csv", 
                      header = TRUE, sep = ",")
```

```{r ALT_AST meta-analysis}
m.ALT_AST <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_ALT_AST,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on ALT_AST")

m.ALT_AST <- update(m.ALT_AST, prediction = TRUE) # Adds the prediction interval

summary(m.ALT_AST) # Results of meta-analysis
```

```{r Outlier search ALT_AST}
find.outliers(m.ALT_AST) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases ALT_AST}
m.ALT_AST.inf <- InfluenceAnalysis(m.ALT_AST, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots ALT_AST}
plot(m.ALT_AST.inf, "baujat")
plot(m.ALT_AST.inf, "influence")
plot(m.ALT_AST.inf, "es")
plot(m.ALT_AST.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot ALT_AST}
m.rma_ALT_AST <- rma(yi = m.ALT_AST$TE,
             sei = m.ALT_AST$seTE,
             method = m.ALT_AST$method.tau,
             test = "knha")

res.gosh_ALT_AST <- gosh(m.rma_ALT_AST)

plot(res.gosh_ALT_AST, alpha = 0.01)

res.gosh.diag_ALT_AST <- gosh.diagnostics(res.gosh_ALT_AST, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_ALT_AST)
```

```{r Update analysis if necessary}
# update(m.ALT_AST, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot ALT_AST}
meta::forest(m.ALT_AST, layout = "RevMan5")
```

```{r Saving forest plot ALT_AST}
pdf(file = "ALT_AST_forestplot.pdf", width = 10, height = 7)

meta::forest(m.ALT_AST, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.ALT_AST, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression ALT_AST}
m.ALT_AST.reg <- metareg(m.ALT_AST, ~Age)
m.ALT_AST.reg
```


```{r Bubble plot ALT_AST}
bubble(m.ALT_AST.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot ALT_AST}
meta::funnel(m.ALT_AST,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (ALT_AST)")
```

```{r Contour funnel plot ALT_AST}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.ALT_AST, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (ALT_AST)")
```

```{r Egger's regression test}
metabias(m.ALT_AST, method.bias = "linreg")

# Alternative:
m.ALT_AST$n.e = n1; m.ALT_AST$n.c = n2
metabias(m.ALT_AST, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.ALT_AST_update <- update(m.ALT_AST, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.ALT_AST_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Meta-analysis: ALP

```{r Read in ALP data, include=FALSE}
Liver_disease_ALP <- read.csv("MA_human_ALP.csv", 
                      header = TRUE, sep = ",")
```

```{r ALP meta-analysis}
m.ALP <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_ALP,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on ALP")

m.ALP <- update(m.ALP, prediction = TRUE) # Adds the prediction interval

summary(m.ALP) # Results of meta-analysis
```

```{r Outlier search ALP}
find.outliers(m.ALP) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases ALP}
m.ALP.inf <- InfluenceAnalysis(m.ALP, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots ALP}
plot(m.ALP.inf, "baujat")
plot(m.ALP.inf, "influence")
plot(m.ALP.inf, "es")
plot(m.ALP.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot ALP}
m.rma_ALP <- rma(yi = m.ALP$TE,
             sei = m.ALP$seTE,
             method = m.ALP$method.tau,
             test = "knha")

res.gosh_ALP <- gosh(m.rma_ALP)

plot(res.gosh_ALP, alpha = 0.01)

res.gosh.diag_ALP <- gosh.diagnostics(res.gosh_ALP, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_ALP)
```

```{r Update analysis if necessary}
# update(m.ALP, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot ALP}
meta::forest(m.ALP, layout = "RevMan5")
```

```{r Saving forest plot ALP}
pdf(file = "ALP_forestplot.pdf", width = 10, height = 7)

meta::forest(m.ALP, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.ALP, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression ALP}
m.ALP.reg <- metareg(m.ALP, ~Age)
m.ALP.reg
```


```{r Bubble plot ALP}
bubble(m.ALP.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot ALP}
meta::funnel(m.ALP,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (ALP)")
```

```{r Contour funnel plot ALP}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.ALP, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (ALP)")
```

```{r Egger's regression test}
metabias(m.ALP, method.bias = "linreg")

# Alternative:
m.ALP$n.e = n1; m.ALP$n.c = n2
metabias(m.ALP, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.ALP_update <- update(m.ALP, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.ALP_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Meta-analysis: LDL

```{r Read in LDL data, include=FALSE}
Liver_disease_LDL <- read.csv("MA_human_LDL.csv", 
                      header = TRUE, sep = ",")
```

```{r LDL meta-analysis}
m.LDL <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_LDL,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on LDL")

m.LDL <- update(m.LDL, prediction = TRUE) # Adds the prediction interval

summary(m.LDL) # Results of meta-analysis
```

```{r Outlier search LDL}
find.outliers(m.LDL) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases LDL}
m.LDL.inf <- InfluenceAnalysis(m.LDL, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots LDL}
plot(m.LDL.inf, "baujat")
plot(m.LDL.inf, "influence")
plot(m.LDL.inf, "es")
plot(m.LDL.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot LDL}
m.rma_LDL <- rma(yi = m.LDL$TE,
             sei = m.LDL$seTE,
             method = m.LDL$method.tau,
             test = "knha")

res.gosh_LDL <- gosh(m.rma_LDL)

plot(res.gosh_LDL, alpha = 0.01)

res.gosh.diag_LDL <- gosh.diagnostics(res.gosh_LDL, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_LDL)
```

```{r Update analysis if necessary}
# update(m.LDL, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot LDL}
meta::forest(m.LDL, layout = "RevMan5")
```

```{r Saving forest plot LDL}
pdf(file = "LDL_forestplot.pdf", width = 10, height = 7)

meta::forest(m.LDL, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.LDL, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression LDL}
m.LDL.reg <- metareg(m.LDL, ~Age)
m.LDL.reg
```


```{r Bubble plot LDL}
bubble(m.LDL.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot LDL}
meta::funnel(m.LDL,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (LDL)")
```

```{r Contour funnel plot LDL}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.LDL, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (LDL)")
```

```{r Egger's regression test}
metabias(m.LDL, method.bias = "linreg")

# Alternative:
m.LDL$n.e = n1; m.LDL$n.c = n2
metabias(m.LDL, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.LDL_update <- update(m.LDL, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.LDL_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Meta-analysis: HDL

```{r Read in HDL data, include=FALSE}
Liver_disease_HDL <- read.csv("MA_human_HDL.csv", 
                      header = TRUE, sep = ",")
```

```{r HDL meta-analysis}
m.HDL <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_HDL,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on HDL")

m.HDL <- update(m.HDL, prediction = TRUE) # Adds the prediction interval

summary(m.HDL) # Results of meta-analysis
```

```{r Outlier search HDL}
find.outliers(m.HDL) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases HDL}
m.HDL.inf <- InfluenceAnalysis(m.HDL, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots HDL}
plot(m.HDL.inf, "baujat")
plot(m.HDL.inf, "influence")
plot(m.HDL.inf, "es")
plot(m.HDL.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot HDL}
m.rma_HDL <- rma(yi = m.HDL$TE,
             sei = m.HDL$seTE,
             method = m.HDL$method.tau,
             test = "knha")

res.gosh_HDL <- gosh(m.rma_HDL)

plot(res.gosh_HDL, alpha = 0.01)

res.gosh.diag_HDL <- gosh.diagnostics(res.gosh_HDL, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_HDL)
```

```{r Update analysis if necessary}
# update(m.HDL, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot HDL}
meta::forest(m.HDL, layout = "RevMan5")
```

```{r Saving forest plot HDL}
pdf(file = "HDL_forestplot.pdf", width = 10, height = 7)

meta::forest(m.HDL, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.HDL, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression HDL}
m.HDL.reg <- metareg(m.HDL, ~Age)
m.HDL.reg
```


```{r Bubble plot HDL}
bubble(m.HDL.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot HDL}
meta::funnel(m.HDL,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (HDL)")
```

```{r Contour funnel plot HDL}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.HDL, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (HDL)")
```

```{r Egger's regression test}
metabias(m.HDL, method.bias = "linreg")

# Alternative:
m.HDL$n.e = n1; m.HDL$n.c = n2
metabias(m.HDL, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.HDL_update <- update(m.HDL, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.HDL_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: Cholesterol

```{r Read in cholesterol data, include=FALSE}
Liver_disease_cholesterol <- read.csv("MA_human_cholesterol.csv", 
                      header = TRUE, sep = ",")
```

```{r cholesterol meta-analysis}
m.cholesterol <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_cholesterol,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on cholesterol")

m.cholesterol <- update(m.cholesterol, prediction = TRUE) # Adds the prediction interval

summary(m.cholesterol) # Results of meta-analysis
```

```{r Outlier search cholesterol}
find.outliers(m.cholesterol) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases cholesterol}
m.cholesterol.inf <- InfluenceAnalysis(m.cholesterol, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots cholesterol}
plot(m.cholesterol.inf, "baujat")
plot(m.cholesterol.inf, "influence")
plot(m.cholesterol.inf, "es")
plot(m.cholesterol.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot cholesterol}
m.rma_cholesterol <- rma(yi = m.cholesterol$TE,
             sei = m.cholesterol$seTE,
             method = m.cholesterol$method.tau,
             test = "knha")

res.gosh_cholesterol <- gosh(m.rma_cholesterol)

plot(res.gosh_cholesterol, alpha = 0.01)

res.gosh.diag_cholesterol <- gosh.diagnostics(res.gosh_cholesterol, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_cholesterol)
```

```{r Update analysis if necessary}
# update(m.cholesterol, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot cholesterol}
meta::forest(m.cholesterol, layout = "RevMan5")
```

```{r Saving forest plot cholesterol}
pdf(file = "Cholesterol_forestplot.pdf", width = 10, height = 7)

meta::forest(m.cholesterol, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.cholesterol, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression cholesterol}
m.cholesterol.reg <- metareg(m.cholesterol, ~Age)
m.cholesterol.reg
```


```{r Bubble plot cholesterol}
bubble(m.cholesterol.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot cholesterol}
meta::funnel(m.cholesterol,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (cholesterol)")
```

```{r Contour funnel plot cholesterol}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.cholesterol, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (cholesterol)")
```

```{r Egger's regression test}
metabias(m.cholesterol, method.bias = "linreg")

# Alternative:
m.cholesterol$n.e = n1; m.cholesterol$n.c = n2
metabias(m.cholesterol, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.cholesterol_update <- update(m.cholesterol, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.cholesterol_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: GGT

```{r Read in GGT data, include=FALSE}
Liver_disease_GGT <- read.csv("MA_human_GGT.csv", 
                      header = TRUE, sep = ",")
```

```{r GGT meta-analysis}
m.GGT <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_GGT,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on GGT")

m.GGT <- update(m.GGT, prediction = TRUE) # Adds the prediction interval

summary(m.GGT) # Results of meta-analysis
```

```{r Outlier search GGT}
find.outliers(m.GGT) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases GGT}
m.GGT.inf <- InfluenceAnalysis(m.GGT, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots GGT}
plot(m.GGT.inf, "baujat")
plot(m.GGT.inf, "influence")
plot(m.GGT.inf, "es")
plot(m.GGT.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot GGT}
m.rma_GGT <- rma(yi = m.GGT$TE,
             sei = m.GGT$seTE,
             method = m.GGT$method.tau,
             test = "knha")

res.gosh_GGT <- gosh(m.rma_GGT)

plot(res.gosh_GGT, alpha = 0.01)

res.gosh.diag_GGT <- gosh.diagnostics(res.gosh_GGT, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_GGT)
```

```{r Update analysis if necessary}
# update(m.GGT, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot GGT}
meta::forest(m.GGT, layout = "RevMan5")
```

```{r Saving forest plot GGT}
pdf(file = "GGT_forestplot.pdf", width = 10, height = 7)

meta::forest(m.GGT, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.GGT, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression GGT}
m.GGT.reg <- metareg(m.GGT, ~Age)
m.GGT.reg
```


```{r Bubble plot GGT}
bubble(m.GGT.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot GGT}
meta::funnel(m.GGT,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (GGT)")
```

```{r Contour funnel plot GGT}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.GGT, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (GGT)")
```

```{r Egger's regression test}
metabias(m.GGT, method.bias = "linreg")

# Alternative:
m.GGT$n.e = n1; m.GGT$n.c = n2
metabias(m.GGT, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.GGT_update <- update(m.GGT, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.GGT_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: Albumin

```{r Read in albumin data, include=FALSE}
Liver_disease_albumin <- read.csv("MA_human_albumin.csv", 
                      header = TRUE, sep = ",")
```

```{r albumin meta-analysis}
m.albumin <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_albumin,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on albumin")

m.albumin <- update(m.albumin, prediction = TRUE) # Adds the prediction interval

summary(m.albumin) # Results of meta-analysis
```

```{r Outlier search albumin}
find.outliers(m.albumin) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases albumin}
m.albumin.inf <- InfluenceAnalysis(m.albumin, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots albumin}
plot(m.albumin.inf, "baujat")
plot(m.albumin.inf, "influence")
plot(m.albumin.inf, "es")
plot(m.albumin.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot albumin}
m.rma_albumin <- rma(yi = m.albumin$TE,
             sei = m.albumin$seTE,
             method = m.albumin$method.tau,
             test = "knha")

res.gosh_albumin <- gosh(m.rma_albumin)

plot(res.gosh_albumin, alpha = 0.01)

res.gosh.diag_albumin <- gosh.diagnostics(res.gosh_albumin, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_albumin)
```

```{r Update analysis if necessary}
# update(m.albumin, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot albumin}
meta::forest(m.albumin, layout = "RevMan5")
```

```{r Saving forest plot albumin}
pdf(file = "Albumin_forestplot.pdf", width = 10, height = 7)

meta::forest(m.albumin, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.albumin, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression albumin}
m.albumin.reg <- metareg(m.albumin, ~Age)
m.albumin.reg
```


```{r Bubble plot albumin}
bubble(m.albumin.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot albumin}
meta::funnel(m.albumin,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (albumin)")
```

```{r Contour funnel plot albumin}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.albumin, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (albumin)")
```

```{r Egger's regression test}
metabias(m.albumin, method.bias = "linreg")

# Alternative:
m.albumin$n.e = n1; m.albumin$n.c = n2
metabias(m.albumin, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.albumin_update <- update(m.albumin, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.albumin_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: APRI

```{r Read in APRI data, include=FALSE}
Liver_disease_APRI <- read.csv("MA_human_APRI.csv", 
                      header = TRUE, sep = ",")
```

```{r APRI meta-analysis}
m.APRI <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_APRI,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on APRI")

m.APRI <- update(m.APRI, prediction = TRUE) # Adds the prediction interval

summary(m.APRI) # Results of meta-analysis
```

```{r Outlier search APRI}
find.outliers(m.APRI) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases APRI}
m.APRI.inf <- InfluenceAnalysis(m.APRI, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots APRI}
plot(m.APRI.inf, "baujat")
plot(m.APRI.inf, "influence")
plot(m.APRI.inf, "es")
plot(m.APRI.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot APRI}
m.rma_APRI <- rma(yi = m.APRI$TE,
             sei = m.APRI$seTE,
             method = m.APRI$method.tau,
             test = "knha")

res.gosh_APRI <- gosh(m.rma_APRI)

plot(res.gosh_APRI, alpha = 0.01)

res.gosh.diag_APRI <- gosh.diagnostics(res.gosh_APRI, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_APRI)
```

```{r Update analysis if necessary}
# update(m.APRI, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot APRI}
meta::forest(m.APRI, layout = "RevMan5")
```

```{r Saving forest plot APRI}
pdf(file = "APRI_forestplot.pdf", width = 10, height = 7)

meta::forest(m.APRI, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.APRI, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression APRI}
m.APRI.reg <- metareg(m.APRI, ~Age)
m.APRI.reg
```


```{r Bubble plot APRI}
bubble(m.APRI.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot APRI}
meta::funnel(m.APRI,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (APRI)")
```

```{r Contour funnel plot APRI}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.APRI, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (APRI)")
```

```{r Egger's regression test}
metabias(m.APRI, method.bias = "linreg")

# Alternative:
m.APRI$n.e = n1; m.APRI$n.c = n2
metabias(m.APRI, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.APRI_update <- update(m.APRI, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.APRI_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: IHL

```{r Read in IHL data, include=FALSE}
Liver_disease_IHL <- read.csv("MA_human_IHL.csv", 
                      header = TRUE, sep = ",")
```

```{r IHL meta-analysis}
m.IHL <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_IHL,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on IHL")

m.IHL <- update(m.IHL, prediction = TRUE) # Adds the prediction interval

summary(m.IHL) # Results of meta-analysis
```

```{r Outlier search IHL}
find.outliers(m.IHL) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases IHL}
m.IHL.inf <- InfluenceAnalysis(m.IHL, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots IHL}
plot(m.IHL.inf, "baujat")
plot(m.IHL.inf, "influence")
plot(m.IHL.inf, "es")
plot(m.IHL.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot IHL}
m.rma_IHL <- rma(yi = m.IHL$TE,
             sei = m.IHL$seTE,
             method = m.IHL$method.tau,
             test = "knha")

res.gosh_IHL <- gosh(m.rma_IHL)

plot(res.gosh_IHL, alpha = 0.01)

res.gosh.diag_IHL <- gosh.diagnostics(res.gosh_IHL, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_IHL)
```

```{r Update analysis if necessary}
# update(m.IHL, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot IHL}
meta::forest(m.IHL, layout = "RevMan5")
```

```{r Saving forest plot IHL}
pdf(file = "IHL_forestplot.pdf", width = 10, height = 7)

meta::forest(m.IHL, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.IHL, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression IHL}
m.IHL.reg <- metareg(m.IHL, ~Age)
m.IHL.reg
```


```{r Bubble plot IHL}
bubble(m.IHL.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot IHL}
meta::funnel(m.IHL,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (IHL)")
```

```{r Contour funnel plot IHL}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.IHL, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (IHL)")
```

```{r Egger's regression test}
metabias(m.IHL, method.bias = "linreg")

# Alternative:
m.IHL$n.e = n1; m.IHL$n.c = n2
metabias(m.IHL, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.IHL_update <- update(m.IHL, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.IHL_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: NFS

```{r Read in NFS data, include=FALSE}
Liver_disease_NFS <- read.csv("MA_human_NFS.csv", 
                      header = TRUE, sep = ",")
```

```{r NFS meta-analysis}
m.NFS <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_NFS,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on NFS")

m.NFS <- update(m.NFS, prediction = TRUE) # Adds the prediction interval

summary(m.NFS) # Results of meta-analysis
```

```{r Outlier search NFS}
find.outliers(m.NFS) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases NFS}
m.NFS.inf <- InfluenceAnalysis(m.NFS, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots NFS}
plot(m.NFS.inf, "baujat")
plot(m.NFS.inf, "influence")
plot(m.NFS.inf, "es")
plot(m.NFS.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot NFS}
m.rma_NFS <- rma(yi = m.NFS$TE,
             sei = m.NFS$seTE,
             method = m.NFS$method.tau,
             test = "knha")

res.gosh_NFS <- gosh(m.rma_NFS)

plot(res.gosh_NFS, alpha = 0.01)

res.gosh.diag_NFS <- gosh.diagnostics(res.gosh_NFS, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_NFS)
```

```{r Update analysis if necessary}
# update(m.NFS, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot NFS}
meta::forest(m.NFS, layout = "RevMan5")
```

```{r Saving forest plot NFS}
pdf(file = "NFS_forestplot.pdf", width = 10, height = 7)

meta::forest(m.NFS, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.NFS, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression NFS}
m.NFS.reg <- metareg(m.NFS, ~Age)
m.NFS.reg
```


```{r Bubble plot NFS}
bubble(m.NFS.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot NFS}
meta::funnel(m.NFS,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (NFS)")
```

```{r Contour funnel plot NFS}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.NFS, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (NFS)")
```

```{r Egger's regression test}
metabias(m.NFS, method.bias = "linreg")

# Alternative:
m.NFS$n.e = n1; m.NFS$n.c = n2
metabias(m.NFS, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.NFS_update <- update(m.NFS, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.NFS_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: Serum_TG

```{r Read in serum_TG data, include=FALSE}
Liver_disease_serum_TG <- read.csv("MA_human_serum_TG.csv", 
                      header = TRUE, sep = ",")
```

```{r serum_TG meta-analysis}
m.serum_TG <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_serum_TG,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on serum_TG")

m.serum_TG <- update(m.serum_TG, prediction = TRUE) # Adds the prediction interval

summary(m.serum_TG) # Results of meta-analysis
```

```{r Outlier search serum_TG}
find.outliers(m.serum_TG) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases serum_TG}
m.serum_TG.inf <- InfluenceAnalysis(m.serum_TG, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots serum_TG}
plot(m.serum_TG.inf, "baujat")
plot(m.serum_TG.inf, "influence")
plot(m.serum_TG.inf, "es")
plot(m.serum_TG.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot serum_TG}
m.rma_serum_TG <- rma(yi = m.serum_TG$TE,
             sei = m.serum_TG$seTE,
             method = m.serum_TG$method.tau,
             test = "knha")

res.gosh_serum_TG <- gosh(m.rma_serum_TG)

plot(res.gosh_serum_TG, alpha = 0.01)

res.gosh.diag_serum_TG <- gosh.diagnostics(res.gosh_serum_TG, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_serum_TG)
```

```{r Update analysis if necessary}
# update(m.serum_TG, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot serum_TG}
meta::forest(m.serum_TG, layout = "RevMan5")
```

```{r Saving forest plot serum_TG}
pdf(file = "Serum_TG_forestplot.pdf", width = 10, height = 7)

meta::forest(m.serum_TG, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.serum_TG, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression serum_TG}
m.serum_TG.reg <- metareg(m.serum_TG, ~Age)
m.serum_TG.reg
```


```{r Bubble plot serum_TG}
bubble(m.serum_TG.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot serum_TG}
meta::funnel(m.serum_TG,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (serum_TG)")
```

```{r Contour funnel plot serum_TG}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.serum_TG, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (serum_TG)")
```

```{r Egger's regression test}
metabias(m.serum_TG, method.bias = "linreg")

# Alternative:
m.serum_TG$n.e = n1; m.serum_TG$n.c = n2
metabias(m.serum_TG, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.serum_TG_update <- update(m.serum_TG, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.serum_TG_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: FIB4

```{r Read in FIB4 data, include=FALSE}
Liver_disease_FIB4 <- read.csv("MA_human_FIB4.csv", 
                      header = TRUE, sep = ",")
```

```{r FIB4 meta-analysis}
m.FIB4 <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_FIB4,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on FIB4")

m.FIB4 <- update(m.FIB4, prediction = TRUE) # Adds the prediction interval

summary(m.FIB4) # Results of meta-analysis
```

```{r Outlier search FIB4}
find.outliers(m.FIB4) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases FIB4}
m.FIB4.inf <- InfluenceAnalysis(m.FIB4, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots FIB4}
plot(m.FIB4.inf, "baujat")
plot(m.FIB4.inf, "influence")
plot(m.FIB4.inf, "es")
plot(m.FIB4.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot FIB4}
m.rma_FIB4 <- rma(yi = m.FIB4$TE,
             sei = m.FIB4$seTE,
             method = m.FIB4$method.tau,
             test = "knha")

res.gosh_FIB4 <- gosh(m.rma_FIB4)

plot(res.gosh_FIB4, alpha = 0.01)

res.gosh.diag_FIB4 <- gosh.diagnostics(res.gosh_FIB4, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_FIB4)
```

```{r Update analysis if necessary}
# update(m.FIB4, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot FIB4}
meta::forest(m.FIB4, layout = "RevMan5")
```

```{r Saving forest plot FIB4}
pdf(file = "FIB4_forestplot.pdf", width = 10, height = 7)

meta::forest(m.FIB4, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.FIB4, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression FIB4}
m.FIB4.reg <- metareg(m.FIB4, ~Age)
m.FIB4.reg
```


```{r Bubble plot FIB4}
bubble(m.FIB4.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot FIB4}
meta::funnel(m.FIB4,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (FIB4)")
```

```{r Contour funnel plot FIB4}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.FIB4, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (FIB4)")
```

```{r Egger's regression test}
metabias(m.FIB4, method.bias = "linreg")

# Alternative:
m.FIB4$n.e = n1; m.FIB4$n.c = n2
metabias(m.FIB4, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.FIB4_update <- update(m.FIB4, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.FIB4_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Meta-analysis: Ferritin

```{r Read in ferritin data, include=FALSE}
Liver_disease_ferritin <- read.csv("MA_human_ferritin.csv", 
                      header = TRUE, sep = ",")
```

```{r ferritin meta-analysis}
m.ferritin <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_ferritin,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on ferritin")

m.ferritin <- update(m.ferritin, prediction = TRUE) # Adds the prediction interval

summary(m.ferritin) # Results of meta-analysis
```

```{r Outlier search ferritin}
find.outliers(m.ferritin) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases ferritin}
m.ferritin.inf <- InfluenceAnalysis(m.ferritin, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots ferritin}
plot(m.ferritin.inf, "baujat")
plot(m.ferritin.inf, "influence")
plot(m.ferritin.inf, "es")
plot(m.ferritin.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot ferritin}
m.rma_ferritin <- rma(yi = m.ferritin$TE,
             sei = m.ferritin$seTE,
             method = m.ferritin$method.tau,
             test = "knha")

res.gosh_ferritin <- gosh(m.rma_ferritin)

plot(res.gosh_ferritin, alpha = 0.01)

res.gosh.diag_ferritin <- gosh.diagnostics(res.gosh_ferritin, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_ferritin)
```

```{r Update analysis if necessary}
# update(m.ferritin, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot ferritin}
meta::forest(m.ferritin, layout = "RevMan5")
```

```{r Saving forest plot ferritin}
pdf(file = "Ferritin_forestplot.pdf", width = 11, height = 7)

meta::forest(m.ferritin, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.ferritin, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression ferritin}
m.ferritin.reg <- metareg(m.ferritin, ~Age)
m.ferritin.reg
```


```{r Bubble plot ferritin}
bubble(m.ferritin.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot ferritin}
meta::funnel(m.ferritin,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (ferritin)")
```

```{r Contour funnel plot ferritin}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.ferritin, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (ferritin)")
```

```{r Egger's regression test}
metabias(m.ferritin, method.bias = "linreg")

# Alternative:
m.ferritin$n.e = n1; m.ferritin$n.c = n2
metabias(m.ferritin, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.ferritin_update <- update(m.ferritin, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.ferritin_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: FLI

```{r Read in FLI data, include=FALSE}
Liver_disease_FLI <- read.csv("MA_human_FLI.csv", 
                      header = TRUE, sep = ",")
```

```{r FLI meta-analysis}
m.FLI <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_FLI,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on FLI")

m.FLI <- update(m.FLI, prediction = TRUE) # Adds the prediction interval

summary(m.FLI) # Results of meta-analysis
```

```{r Outlier search FLI}
find.outliers(m.FLI) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases FLI}
m.FLI.inf <- InfluenceAnalysis(m.FLI, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots FLI}
plot(m.FLI.inf, "baujat")
plot(m.FLI.inf, "influence")
plot(m.FLI.inf, "es")
plot(m.FLI.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot FLI}
m.rma_FLI <- rma(yi = m.FLI$TE,
             sei = m.FLI$seTE,
             method = m.FLI$method.tau,
             test = "knha")

res.gosh_FLI <- gosh(m.rma_FLI)

plot(res.gosh_FLI, alpha = 0.01)

res.gosh.diag_FLI <- gosh.diagnostics(res.gosh_FLI, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_FLI)
```

```{r Update analysis if necessary}
# update(m.FLI, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot FLI}
meta::forest(m.FLI, layout = "RevMan5")
```

```{r Saving forest plot FLI}
pdf(file = "FLI_forestplot.pdf", width = 10, height = 7)

meta::forest(m.FLI, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.FLI, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression FLI}
m.FLI.reg <- metareg(m.FLI, ~Age)
m.FLI.reg
```


```{r Bubble plot FLI}
bubble(m.FLI.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot FLI}
meta::funnel(m.FLI,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (FLI)")
```

```{r Contour funnel plot FLI}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.FLI, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (FLI)")
```

```{r Egger's regression test}
metabias(m.FLI, method.bias = "linreg")

# Alternative:
m.FLI$n.e = n1; m.FLI$n.c = n2
metabias(m.FLI, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.FLI_update <- update(m.FLI, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.FLI_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: Liver Fat Percentage

```{r Read in liver_fat_percentage data, include=FALSE}
Liver_disease_liver_fat_percentage <- read.csv("MA_human_liver_fat_percentage.csv", 
                      header = TRUE, sep = ",")
```

```{r liver_fat_percentage meta-analysis}
m.liver_fat_percentage <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_liver_fat_percentage,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on liver_fat_percentage")

m.liver_fat_percentage <- update(m.liver_fat_percentage, prediction = TRUE) # Adds the prediction interval

summary(m.liver_fat_percentage) # Results of meta-analysis
```

```{r Outlier search liver_fat_percentage}
find.outliers(m.liver_fat_percentage) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases liver_fat_percentage}
m.liver_fat_percentage.inf <- InfluenceAnalysis(m.liver_fat_percentage, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots liver_fat_percentage}
plot(m.liver_fat_percentage.inf, "baujat")
plot(m.liver_fat_percentage.inf, "influence")
plot(m.liver_fat_percentage.inf, "es")
plot(m.liver_fat_percentage.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot liver_fat_percentage}
m.rma_liver_fat_percentage <- rma(yi = m.liver_fat_percentage$TE,
             sei = m.liver_fat_percentage$seTE,
             method = m.liver_fat_percentage$method.tau,
             test = "knha")

res.gosh_liver_fat_percentage <- gosh(m.rma_liver_fat_percentage)

plot(res.gosh_liver_fat_percentage, alpha = 0.01)

res.gosh.diag_liver_fat_percentage <- gosh.diagnostics(res.gosh_liver_fat_percentage, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_liver_fat_percentage)
```

```{r Update analysis if necessary}
# update(m.liver_fat_percentage, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot liver_fat_percentage}
meta::forest(m.liver_fat_percentage, layout = "RevMan5")
```

```{r Saving forest plot liver_fat_percentage}
pdf(file = "liver_fat_percentage_forestplot.pdf", width = 10, height = 7)

meta::forest(m.liver_fat_percentage, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.liver_fat_percentage, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression liver_fat_percentage}
m.liver_fat_percentage.reg <- metareg(m.liver_fat_percentage, ~Age)
m.liver_fat_percentage.reg
```


```{r Bubble plot liver_fat_percentage}
bubble(m.liver_fat_percentage.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot liver_fat_percentage}
meta::funnel(m.liver_fat_percentage,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (liver_fat_percentage)")
```

```{r Contour funnel plot liver_fat_percentage}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.liver_fat_percentage, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (liver_fat_percentage)")
```

```{r Egger's regression test}
metabias(m.liver_fat_percentage, method.bias = "linreg")

# Alternative:
m.liver_fat_percentage$n.e = n1; m.liver_fat_percentage$n.c = n2
metabias(m.liver_fat_percentage, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.liver_fat_percentage_update <- update(m.liver_fat_percentage, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.liver_fat_percentage_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: IHTG

```{r Read in IHTG data, include=FALSE}
Liver_disease_IHTG <- read.csv("MA_human_IHTG.csv", 
                      header = TRUE, sep = ",")
```

```{r IHTG meta-analysis}
m.IHTG <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_IHTG,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on IHTG")

m.IHTG <- update(m.IHTG, prediction = TRUE) # Adds the prediction interval

summary(m.IHTG) # Results of meta-analysis
```

```{r Outlier search IHTG}
find.outliers(m.IHTG) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases IHTG}
m.IHTG.inf <- InfluenceAnalysis(m.IHTG, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots IHTG}
plot(m.IHTG.inf, "baujat")
plot(m.IHTG.inf, "influence")
plot(m.IHTG.inf, "es")
plot(m.IHTG.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot IHTG}
m.rma_IHTG <- rma(yi = m.IHTG$TE,
             sei = m.IHTG$seTE,
             method = m.IHTG$method.tau,
             test = "knha")

res.gosh_IHTG <- gosh(m.rma_IHTG)

plot(res.gosh_IHTG, alpha = 0.01)

res.gosh.diag_IHTG <- gosh.diagnostics(res.gosh_IHTG, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_IHTG)
```

```{r Update analysis if necessary}
# update(m.IHTG, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot IHTG}
meta::forest(m.IHTG, layout = "RevMan5")
```

```{r Saving forest plot IHTG}
pdf(file = "IHTG_forestplot.pdf", width = 10, height = 7)

meta::forest(m.IHTG, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.IHTG, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression IHTG}
m.IHTG.reg <- metareg(m.IHTG, ~Age)
m.IHTG.reg
```


```{r Bubble plot IHTG}
bubble(m.IHTG.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot IHTG}
meta::funnel(m.IHTG,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (IHTG)")
```

```{r Contour funnel plot IHTG}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.IHTG, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (IHTG)")
```

```{r Egger's regression test}
metabias(m.IHTG, method.bias = "linreg")

# Alternative:
m.IHTG$n.e = n1; m.IHTG$n.c = n2
metabias(m.IHTG, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.IHTG_update <- update(m.IHTG, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.IHTG_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: Adiponectin

```{r Read in adiponectin data, include=FALSE}
Liver_disease_adiponectin <- read.csv("MA_human_adiponectin.csv", 
                      header = TRUE, sep = ",")
```

```{r adiponectin meta-analysis}
m.adiponectin <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_adiponectin,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on adiponectin")

m.adiponectin <- update(m.adiponectin, prediction = TRUE) # Adds the prediction interval

summary(m.adiponectin) # Results of meta-analysis
```

```{r Outlier search adiponectin}
find.outliers(m.adiponectin) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases adiponectin}
m.adiponectin.inf <- InfluenceAnalysis(m.adiponectin, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots adiponectin}
plot(m.adiponectin.inf, "baujat")
plot(m.adiponectin.inf, "influence")
plot(m.adiponectin.inf, "es")
plot(m.adiponectin.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot adiponectin}
m.rma_adiponectin <- rma(yi = m.adiponectin$TE,
             sei = m.adiponectin$seTE,
             method = m.adiponectin$method.tau,
             test = "knha")

res.gosh_adiponectin <- gosh(m.rma_adiponectin)

plot(res.gosh_adiponectin, alpha = 0.01)

res.gosh.diag_adiponectin <- gosh.diagnostics(res.gosh_adiponectin, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_adiponectin)
```

```{r Update analysis if necessary}
# update(m.adiponectin, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot adiponectin}
meta::forest(m.adiponectin, layout = "RevMan5")
```

```{r Saving forest plot adiponectin}
pdf(file = "adiponectin_forestplot.pdf", width = 10, height = 7)

meta::forest(m.adiponectin, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.adiponectin, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression adiponectin}
m.adiponectin.reg <- metareg(m.adiponectin, ~Age)
m.adiponectin.reg
```


```{r Bubble plot adiponectin}
bubble(m.adiponectin.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot adiponectin}
meta::funnel(m.adiponectin,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (adiponectin)")
```

```{r Contour funnel plot adiponectin}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.adiponectin, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (adiponectin)")
```

```{r Egger's regression test}
metabias(m.adiponectin, method.bias = "linreg")

# Alternative:
m.adiponectin$n.e = n1; m.adiponectin$n.c = n2
metabias(m.adiponectin, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.adiponectin_update <- update(m.adiponectin, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.adiponectin_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: TNFa

```{r Read in TNFa data, include=FALSE}
Liver_disease_TNFa <- read.csv("MA_human_TNFa.csv", 
                      header = TRUE, sep = ",")
```

```{r TNFa meta-analysis}
m.TNFa <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_TNFa,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on TNFa")

m.TNFa <- update(m.TNFa, prediction = TRUE) # Adds the prediction interval

summary(m.TNFa) # Results of meta-analysis
```

```{r Outlier search TNFa}
find.outliers(m.TNFa) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases TNFa}
m.TNFa.inf <- InfluenceAnalysis(m.TNFa, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots TNFa}
plot(m.TNFa.inf, "baujat")
plot(m.TNFa.inf, "influence")
plot(m.TNFa.inf, "es")
plot(m.TNFa.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot TNFa}
m.rma_TNFa <- rma(yi = m.TNFa$TE,
             sei = m.TNFa$seTE,
             method = m.TNFa$method.tau,
             test = "knha")

res.gosh_TNFa <- gosh(m.rma_TNFa)

plot(res.gosh_TNFa, alpha = 0.01)

res.gosh.diag_TNFa <- gosh.diagnostics(res.gosh_TNFa, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_TNFa)
```

```{r Update analysis if necessary}
# update(m.TNFa, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot TNFa}
meta::forest(m.TNFa, layout = "RevMan5")
```

```{r Saving forest plot TNFa}
pdf(file = "TNFa_forestplot.pdf", width = 10, height = 7)

meta::forest(m.TNFa, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.TNFa, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression TNFa}
m.TNFa.reg <- metareg(m.TNFa, ~Age)
m.TNFa.reg
```


```{r Bubble plot TNFa}
bubble(m.TNFa.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot TNFa}
meta::funnel(m.TNFa,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (TNFa)")
```

```{r Contour funnel plot TNFa}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.TNFa, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (TNFa)")
```

```{r Egger's regression test}
metabias(m.TNFa, method.bias = "linreg")

# Alternative:
m.TNFa$n.e = n1; m.TNFa$n.c = n2
metabias(m.TNFa, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.TNFa_update <- update(m.TNFa, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.TNFa_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: Bilirubin

```{r Read in bilirubin data, include=FALSE}
Liver_disease_bilirubin <- read.csv("MA_human_bilirubin.csv", 
                      header = TRUE, sep = ",")
```

```{r bilirubin meta-analysis}
m.bilirubin <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_bilirubin,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on bilirubin")

m.bilirubin <- update(m.bilirubin, prediction = TRUE) # Adds the prediction interval

summary(m.bilirubin) # Results of meta-analysis
```

```{r Outlier search bilirubin}
find.outliers(m.bilirubin) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases bilirubin}
m.bilirubin.inf <- InfluenceAnalysis(m.bilirubin, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots bilirubin}
plot(m.bilirubin.inf, "baujat")
plot(m.bilirubin.inf, "influence")
plot(m.bilirubin.inf, "es")
plot(m.bilirubin.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot bilirubin}
m.rma_bilirubin <- rma(yi = m.bilirubin$TE,
             sei = m.bilirubin$seTE,
             method = m.bilirubin$method.tau,
             test = "knha")

res.gosh_bilirubin <- gosh(m.rma_bilirubin)

plot(res.gosh_bilirubin, alpha = 0.01)

res.gosh.diag_bilirubin <- gosh.diagnostics(res.gosh_bilirubin, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_bilirubin)
```

```{r Update analysis if necessary}
# update(m.bilirubin, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot bilirubin}
meta::forest(m.bilirubin, layout = "RevMan5")
```

```{r Saving forest plot bilirubin}
pdf(file = "bilirubin_forestplot.pdf", width = 10, height = 7)

meta::forest(m.bilirubin, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.bilirubin, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression bilirubin}
m.bilirubin.reg <- metareg(m.bilirubin, ~Age)
m.bilirubin.reg
```


```{r Bubble plot bilirubin}
bubble(m.bilirubin.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot bilirubin}
meta::funnel(m.bilirubin,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (bilirubin)")
```

```{r Contour funnel plot bilirubin}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.bilirubin, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (bilirubin)")
```

```{r Egger's regression test}
metabias(m.bilirubin, method.bias = "linreg")

# Alternative:
m.bilirubin$n.e = n1; m.bilirubin$n.c = n2
metabias(m.bilirubin, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.bilirubin_update <- update(m.bilirubin, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.bilirubin_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: CK18

```{r Read in ck18 data, include=FALSE}
Liver_disease_ck18 <- read.csv("MA_human_ck18.csv", 
                      header = TRUE, sep = ",")
```

```{r ck18 meta-analysis}
m.ck18 <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_ck18,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on ck18")

m.ck18 <- update(m.ck18, prediction = TRUE) # Adds the prediction interval

summary(m.ck18) # Results of meta-analysis
```

```{r Outlier search ck18}
find.outliers(m.ck18) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases ck18}
m.ck18.inf <- InfluenceAnalysis(m.ck18, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots ck18}
plot(m.ck18.inf, "baujat")
plot(m.ck18.inf, "influence")
plot(m.ck18.inf, "es")
plot(m.ck18.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot ck18}
m.rma_ck18 <- rma(yi = m.ck18$TE,
             sei = m.ck18$seTE,
             method = m.ck18$method.tau,
             test = "knha")

res.gosh_ck18 <- gosh(m.rma_ck18)

plot(res.gosh_ck18, alpha = 0.01)

res.gosh.diag_ck18 <- gosh.diagnostics(res.gosh_ck18, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_ck18)
```

```{r Update analysis if necessary}
# update(m.ck18, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot ck18}
meta::forest(m.ck18, layout = "RevMan5")
```

```{r Saving forest plot ck18}
pdf(file = "ck18_forestplot.pdf", width = 11, height = 7)

meta::forest(m.ck18, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.ck18, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression ck18}
m.ck18.reg <- metareg(m.ck18, ~Age)
m.ck18.reg
```


```{r Bubble plot ck18}
bubble(m.ck18.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot ck18}
meta::funnel(m.ck18,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (ck18)")
```

```{r Contour funnel plot ck18}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.ck18, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (ck18)")
```

```{r Egger's regression test}
metabias(m.ck18, method.bias = "linreg")

# Alternative:
m.ck18$n.e = n1; m.ck18$n.c = n2
metabias(m.ck18, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.ck18_update <- update(m.ck18, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.ck18_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: HsCRP

```{r Read in HsCRP data, include=FALSE}
Liver_disease_HsCRP <- read.csv("MA_human_HsCRP.csv", 
                      header = TRUE, sep = ",")
```

```{r HsCRP meta-analysis}
m.HsCRP <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_HsCRP,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on HsCRP")

m.HsCRP <- update(m.HsCRP, prediction = TRUE) # Adds the prediction interval

summary(m.HsCRP) # Results of meta-analysis
```

```{r Outlier search HsCRP}
find.outliers(m.HsCRP) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases HsCRP}
m.HsCRP.inf <- InfluenceAnalysis(m.HsCRP, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots HsCRP}
plot(m.HsCRP.inf, "baujat")
plot(m.HsCRP.inf, "influence")
plot(m.HsCRP.inf, "es")
plot(m.HsCRP.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot HsCRP}
m.rma_HsCRP <- rma(yi = m.HsCRP$TE,
             sei = m.HsCRP$seTE,
             method = m.HsCRP$method.tau,
             test = "knha")

res.gosh_HsCRP <- gosh(m.rma_HsCRP)

plot(res.gosh_HsCRP, alpha = 0.01)

res.gosh.diag_HsCRP <- gosh.diagnostics(res.gosh_HsCRP, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_HsCRP)
```

```{r Update analysis if necessary}
# update(m.HsCRP, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot HsCRP}
meta::forest(m.HsCRP, layout = "RevMan5")
```

```{r Saving forest plot HsCRP}
pdf(file = "HsCRP_forestplot.pdf", width = 10, height = 7)

meta::forest(m.HsCRP, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.HsCRP, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression HsCRP}
m.HsCRP.reg <- metareg(m.HsCRP, ~Age)
m.HsCRP.reg
```


```{r Bubble plot HsCRP}
bubble(m.HsCRP.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot HsCRP}
meta::funnel(m.HsCRP,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (HsCRP)")
```

```{r Contour funnel plot HsCRP}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.HsCRP, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (HsCRP)")
```

```{r Egger's regression test}
metabias(m.HsCRP, method.bias = "linreg")

# Alternative:
m.HsCRP$n.e = n1; m.HsCRP$n.c = n2
metabias(m.HsCRP, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.HsCRP_update <- update(m.HsCRP, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.HsCRP_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: HOMA

```{r Read in HOMA data, include=FALSE}
Liver_disease_HOMA <- read.csv("MA_human_HOMA.csv", 
                      header = TRUE, sep = ",")
```

```{r HOMA meta-analysis}
m.HOMA <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_HOMA,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on HOMA")

m.HOMA <- update(m.HOMA, prediction = TRUE) # Adds the prediction interval

summary(m.HOMA) # Results of meta-analysis
```

```{r Outlier search HOMA}
find.outliers(m.HOMA) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases HOMA}
m.HOMA.inf <- InfluenceAnalysis(m.HOMA, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots HOMA}
plot(m.HOMA.inf, "baujat")
plot(m.HOMA.inf, "influence")
plot(m.HOMA.inf, "es")
plot(m.HOMA.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot HOMA}
m.rma_HOMA <- rma(yi = m.HOMA$TE,
             sei = m.HOMA$seTE,
             method = m.HOMA$method.tau,
             test = "knha")

res.gosh_HOMA <- gosh(m.rma_HOMA)

plot(res.gosh_HOMA, alpha = 0.01)

res.gosh.diag_HOMA <- gosh.diagnostics(res.gosh_HOMA, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_HOMA)
```

```{r Update analysis if necessary}
# update(m.HOMA, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot HOMA}
meta::forest(m.HOMA, layout = "RevMan5")
```

```{r Saving forest plot HOMA}
pdf(file = "HOMA_forestplot.pdf", width = 10, height = 7)

meta::forest(m.HOMA, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.HOMA, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression HOMA}
m.HOMA.reg <- metareg(m.HOMA, ~Age)
m.HOMA.reg
```


```{r Bubble plot HOMA}
bubble(m.HOMA.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot HOMA}
meta::funnel(m.HOMA,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (HOMA)")
```

```{r Contour funnel plot HOMA}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.HOMA, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (HOMA)")
```

```{r Egger's regression test}
metabias(m.HOMA, method.bias = "linreg")

# Alternative:
m.HOMA$n.e = n1; m.HOMA$n.c = n2
metabias(m.HOMA, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.HOMA_update <- update(m.HOMA, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.HOMA_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: HOMA2

```{r Read in HOMA2 data, include=FALSE}
Liver_disease_HOMA2 <- read.csv("MA_human_HOMA2.csv", 
                      header = TRUE, sep = ",")
```

```{r HOMA2 meta-analysis}
m.HOMA2 <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_HOMA2,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on HOMA2")

m.HOMA2 <- update(m.HOMA2, prediction = TRUE) # Adds the prediction interval

summary(m.HOMA2) # Results of meta-analysis
```

```{r Outlier search HOMA2}
find.outliers(m.HOMA2) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases HOMA2}
m.HOMA2.inf <- InfluenceAnalysis(m.HOMA2, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots HOMA2}
plot(m.HOMA2.inf, "baujat")
plot(m.HOMA2.inf, "influence")
plot(m.HOMA2.inf, "es")
plot(m.HOMA2.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot HOMA2}
m.rma_HOMA2 <- rma(yi = m.HOMA2$TE,
             sei = m.HOMA2$seTE,
             method = m.HOMA2$method.tau,
             test = "knha")

res.gosh_HOMA2 <- gosh(m.rma_HOMA2)

plot(res.gosh_HOMA2, alpha = 0.01)

res.gosh.diag_HOMA2 <- gosh.diagnostics(res.gosh_HOMA2, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_HOMA2)
```

```{r Update analysis if necessary}
# update(m.HOMA2, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot HOMA2}
meta::forest(m.HOMA2, layout = "RevMan5")
```

```{r Saving forest plot HOMA2}
pdf(file = "HOMA2_forestplot.pdf", width = 10, height = 7)

meta::forest(m.HOMA2, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.HOMA2, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression HOMA2}
m.HOMA2.reg <- metareg(m.HOMA2, ~Age)
m.HOMA2.reg
```


```{r Bubble plot HOMA2}
bubble(m.HOMA2.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot HOMA2}
meta::funnel(m.HOMA2,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (HOMA2)")
```

```{r Contour funnel plot HOMA2}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.HOMA2, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (HOMA2)")
```

```{r Egger's regression test}
metabias(m.HOMA2, method.bias = "linreg")

# Alternative:
m.HOMA2$n.e = n1; m.HOMA2$n.c = n2
metabias(m.HOMA2, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.HOMA2_update <- update(m.HOMA2, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.HOMA2_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Meta-analysis: Platelets

```{r Read in platelets data, include=FALSE}
Liver_disease_platelets <- read.csv("MA_human_platelets.csv", 
                      header = TRUE, sep = ",")
```

```{r platelets meta-analysis}
m.platelets <- metacont(n.e = n.e,
                   mean.e = mean.e,
                   sd.e = sd.e,
                   n.c = n.c,
                   mean.c = mean.c,
                   sd.c = sd.c,
                   studlab = author,
                   data = Liver_disease_platelets,
                   sm = "MD",
                   method.smd = "Hedges",
                   fixed = FALSE,
                   random = TRUE,
                   method.tau = "REML",
                   method.random.ci = "HK",
                   title = "Exercise effects on platelets")

m.platelets <- update(m.platelets, prediction = TRUE) # Adds the prediction interval

summary(m.platelets) # Results of meta-analysis
```

```{r Outlier search platelets}
find.outliers(m.platelets) # searches for outlying studies in a object, removes them, and then recalculates the results.
```

Influential cases, on the other hand, are those studies which–by definition–have a large impact on the pooled effect or heterogeneity, regardless of how high or low the effect is. 
Influence diagnostics allow us to detect the studies which influence the overall estimate of our meta-analysis the most.They let us assess if this large influence distorts our pooled effect.

```{r Influential cases platelets}
m.platelets.inf <- InfluenceAnalysis(m.platelets, random = TRUE) #Influence diagnostics allow us to detect the studies that distorts the pooled effect
```


Baujat plots (Baujat et al. 2002) are diagnostic plots to detect studies which overly contribute to the heterogeneity in a meta-analysis. The plot shows the contribution of each study to the overall heterogeneity (as measured by Cochran’s Q) on the horizontal axis, and its influence on the pooled effect size on the vertical axis.

Influence plot displays, for each study, the value of different influence measures. These measures are used to characterize which studies fit well into our meta-analysis model, and which do not. 

Leave-one-out meta-analyses plots show the overall effect and I2 heterogeneity of all meta-analyses that were conducted using the leave-one-out method. We can print two forest plots (a type of plot we will get to know better in Chapter 6.2), one sorted by the pooled effect size, and the other by the I2 value of the leave-one-out meta-analyses.

```{r Influence analysis plots platelets}
plot(m.platelets.inf, "baujat")
plot(m.platelets.inf, "influence")
plot(m.platelets.inf, "es")
plot(m.platelets.inf, "i2")
```

Graphic Display of Heterogeneity (GOSH) plots fit the same meta-analysis model to all possible subsets of our included studies.

```{r Gosh plot platelets}
m.rma_platelets <- rma(yi = m.platelets$TE,
             sei = m.platelets$seTE,
             method = m.platelets$method.tau,
             test = "knha")

res.gosh_platelets <- gosh(m.rma_platelets)

plot(res.gosh_platelets, alpha = 0.01)

res.gosh.diag_platelets <- gosh.diagnostics(res.gosh_platelets, 
                                  km.params = list(centers = 2),
                                  db.params = list(eps = 0.08, 
                                                   MinPts = 50))
res.gosh.diag

plot(res.gosh.diag_platelets)
```

```{r Update analysis if necessary}
# update(m.platelets, exclude = c(3, 4)) %>% 
  # summary()
```

```{r Forest plot platelets}
meta::forest(m.platelets, layout = "RevMan5")
```

```{r Saving forest plot platelets}
pdf(file = "platelets_forestplot.pdf", width = 10, height = 7)

meta::forest(m.platelets, layout = "RevMan5")

dev.off()
```

### Subgroup analyses

```{r Subgroup analysis by disease type}
Disease_subg <- update(m.platelets, 
                    subgroup = Disease_type, 
                    tau.common = FALSE)
```

```{r Forest plot disease type subgoup}
forest(Disease_subg,
            layout = "Revman")
```

### Meta-regression

```{r Metaregression platelets}
m.platelets.reg <- metareg(m.platelets, ~Age)
m.platelets.reg
```


```{r Bubble plot platelets}
bubble(m.platelets.reg, studlab = TRUE)
```

### Publication bias

```{r Funnel plot platelets}
meta::funnel(m.platelets,
             xlim = c(-0.5, 2),
             studlab = TRUE)

# Add title
title("Funnel Plot (platelets)")
```

```{r Contour funnel plot platelets}
# Define fill colors for contour
col.contour = c("gray75", "gray85", "gray95")

# Generate funnel plot (we do not include study labels here)
meta::funnel(m.platelets, xlim = c(-0.5, 2),
             contour = c(0.9, 0.95, 0.99),
             col.contour = col.contour)

# Add a legend
legend(x = 1.6, y = 0.01, 
       legend = c("p < 0.1", "p < 0.05", "p < 0.01"),
       fill = col.contour)

# Add a title
title("Contour-Enhanced Funnel Plot (platelets)")
```

```{r Egger's regression test}
metabias(m.platelets, method.bias = "linreg")

# Alternative:
m.platelets$n.e = n1; m.platelets$n.c = n2
metabias(m.platelets, method.bias = "Pustejovsky")
```

```{r p-curve analysis}
# Update m.gen to exclude outliers
# m.platelets_update <- update(m.platelets, subset = -c(3, 16))

# Run p-curve analysis
pcurve(m.platelets_update)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

